### Test Inscription Utilisateur
POST http://ecoride.local/api/register.php
Content-Type: application/json

{
    "username": "testuser_php1",
    "firstName": "Test",
    "lastName": "PHP",
    "email": "testphp1@example.com",
    "password": "securePassword123",
    "birthdate": "1995-05-15",
    "phone": "0600000011"
}

### Test Connexion Utilisateur (Succès)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "bob_passenger", 
    "password": "newPassword456!" 
}

### Test Connexion Utilisateur (Succès)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "alice_duval", 
    "password": "Password123*" 
}

### Test Connexion Utilisateur (Admin - Succès)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "admin@ecoride.com",
    "password": "adminPass"
}

### Test Connexion Utilisateur (Échec - mauvais mot de passe)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "bob_passenger",
    "password": "wrongpassword"
}

### Test Connexion Utilisateur (Échec - utilisateur inconnu)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "unknown_user",
    "password": "password123"
}

### Test Déconnexion Utilisateur
POST http://ecoride.local/api/logout.php
Content-Type: application/json

### Test de récupération de profil utilisateur 
GET http://ecoride.local/api/account.php 

### Test Mise à Jour Rôle Fonctionnel (Alice devient 'driver')
POST http://ecoride.local/api/update_user_role.php
Content-Type: application/json

{
    "role": "driver" 
}

### Test Mise à Jour Préférences Chauffeur (Alice)
POST http://ecoride.local/api/update_driver_preferences.php
Content-Type: application/json

{
    "pref_smoker": true,
    "pref_animals": false,
    "pref_custom": "Musique rock bienvenue, mais pas trop fort svp !" 
}

### Test Ajout Véhicule (Succès)
POST http://ecoride.local/api/add_vehicle.php
Content-Type: application/json

{
    "brand_id": 6,
    "model_name": "Prius",
    "color": "Jaune",
    "license_plate": "TEST-55-NUL",
    "registration_date": "2020-05-15",
    "passenger_capacity": 2,
    "is_electric": false,
    "energy_type": "Essence"
}

### Test Ajout Véhicule (Échec - brand_id manquant)
POST http://ecoride.local/api/add_vehicle.php
Content-Type: application/json

{
    "model_name": "Modele Sans Marque",
    "license_plate": "ERR-001",
    "passenger_capacity": 4
}

### Test Ajout Véhicule (Échec - plaque dupliquée)
POST http://ecoride.local/api/add_vehicle.php
Content-Type: application/json

{
    "brand_id": 1,
    "model_name": "Autre Modele",
    "license_plate": "NEW-CAR-01", 
    "passenger_capacity": 2
}

### Récupérer la liste des marques
GET http://ecoride.local/api/get_brands.php

### Test Modification Véhicule (Alice - Succès)
POST http://ecoride.local/api/update_vehicle.php
Content-Type: application/json

{
    "id": 1,
    "brand_id": 1,
    "model_name": "208 Style",
    "color": "Gris Foncé",
    "license_plate": "AA-123-BB",
    "registration_date": "2019-03-15",
    "passenger_capacity": 3,
    "is_electric": false,
    "energy_type": "Gasoline"
}

### Test Modification Véhicule (Échec - Mauvais Propriétaire)
POST http://ecoride.local/api/update_vehicle.php
Content-Type: application/json

{
    "id": 2,
    "brand_id": 5,
    "model_name": "Model 3 Hacked",
    "color": "Noir",
    "license_plate": "CC-789-DD",
    "registration_date": "2021-07-01",
    "passenger_capacity": 4,
    "is_electric": true
}

### Test Modification Véhicule (Échec - Plaque Dupliquée)
POST http://ecoride.local/api/update_vehicle.php
Content-Type: application/json

{
    "id": 1, 
    "brand_id": 1,
    "model_name": "208 Test Plaque",
    "color": "Bleu",
    "license_plate": "CC-789-DD",
    "registration_date": "2019-03-15",
    "passenger_capacity": 4,
    "is_electric": false
}

### Test Suppression Véhicule (Alice - Succès)
POST http://ecoride.local/api/delete_vehicle.php
Content-Type: application/json

{
    "vehicle_id": 3
}

### Test Suppression Véhicule (Échec - Mauvais Propriétaire)
POST http://ecoride.local/api/delete_vehicle.php
Content-Type: application/json

{
    "vehicle_id": 2 
}

### Test Suppression Véhicule (Échec - ID Invalide)
POST http://ecoride.local/api/delete_vehicle.php
Content-Type: application/json

{
    "vehicle_id": 9999 
}

### Test Suppression Véhicule (Échec - ID Manquant)
POST http://ecoride.local/api/delete_vehicle.php
Content-Type: application/json

{}

### Test Modification Infos Personnelles (Alice - Succès)
POST http://ecoride.local/api/update_personal_info.php
Content-Type: application/json

{
    "firstName": "AliceUpdated",
    "lastName": "MartinUpdated",
    "username": "alice_updated_nick",
    "email": "alice.martin.updated@email.com",
    "phone": "0699887766",
    "birthdate": "1992-07-21",
    "currentPassword": "password123"
}

### Test Modification Infos Personnelles (Échec - Mauvais Mot de Passe Actuel)
POST http://ecoride.local/api/update_personal_info.php
Content-Type: application/json

{
    "firstName": "AliceNePasChanger",
    "lastName": "MartinNePasChanger",
    "username": "alice_dontchange",
    "email": "alice.dontchange@email.com",
    "phone": "0600000000",
    "birthdate": "1992-07-20",
    "currentPassword": "WRONGpassword123"
}

### Test Modification Infos Personnelles (Échec - Email déjà utilisé)
POST http://ecoride.local/api/update_personal_info.php
Content-Type: application/json

{
    "firstName": "Alice",
    "lastName": "Martin",
    "username": "alice_unique_temp",
    "email": "bob.dupont@email.com",
    "phone": "0611223344",
    "birthdate": "1992-07-20",
    "currentPassword": "password123"
}

### Test Changement Mot de Passe (Bob - Succès)
POST http://ecoride.local/api/update_password.php
Content-Type: application/json

{
    "oldPassword": "password123",
    "newPassword": "newPassword456!", 
    "confirmNewPassword": "newPassword456!"
}

### Test Changement Mot de Passe (Échec - Ancien MDP Incorrect)
POST http://ecoride.local/api/update_password.php
Content-Type: application/json

{
    "oldPassword": "WRONGoldPassword",
    "newPassword": "anotherNewPassword789!",
    "confirmNewPassword": "anotherNewPassword789!"
}

### Test Changement Mot de Passe (Échec - Confirmation MDP Incorrecte)
POST http://ecoride.local/api/update_password.php
Content-Type: application/json

{
    "oldPassword": "newPassword456!",  // Le nouveau mot de passe actuel d'Alice
    "newPassword": "verySecurePassword1!",
    "confirmNewPassword": "DIFFERENTPassword1!" 
}

### Test Changement Mot de Passe (Échec - Nouveau MDP trop simple)
POST http://ecoride.local/api/update_password.php
Content-Type: application/json

{
    "oldPassword": "newPassword456!", 
    "newPassword": "short",
    "confirmNewPassword": "short"
}

### Connexion Utilisateur (Pour Test Suppression Compte - todelete_user1)
POST http://ecoride.local/api/login.php
Content-Type: application/json

{
    "identifier": "todelete_user1", 
    "password": "password123" 
}

### Test Suppression Compte Utilisateur (Succès - todelete_user1)
POST http://ecoride.local/api/delete_account.php
Content-Type: application/json

{}

### Test Suppression Compte Utilisateur (Échec - Non Authentifié)
POST http://ecoride.local/api/delete_account.php
Content-Type: application/json

{}

### Test Publication de Trajet (Succès)
POST http://ecoride.local/api/publish_ride.php
Content-Type: application/json

{
    "departure_city": "Rennes",
    "arrival_city": "Nantes",
    "departure_address": "Place de la Mairie, Rennes",
    "arrival_address": "Château des Ducs, Nantes",
    "departure_datetime": "2025-05-25T14:00",
    "estimated_arrival_datetime": "2025-05-25T15:30", 
    "vehicle_id": 1, 
    "seats_offered": 1,
    "price_per_seat": 10,
    "driver_message": "Voyage direct, musique à la demande !" 
}

### Test Recherche Trajets (Brest vers Vannes)
GET http://ecoride.local/api/search_rides.php?departure_city=Brest&arrival_city=Vannes&date=2025-05-21&seats=1

### Test Récupération Détails Trajet (Ride ID 4 - Carole)
GET http://ecoride.local/api/get_ride_details.php?ride_id=4

### Test Récupération Détails Trajet (Ride ID 1 - Alice)
GET http://ecoride.local/api/get_ride_details.php?ride_id=1

### Test Récupération Détails Trajet (ID Invalide)
GET http://ecoride.local/api/get_ride_details.php?ride_id=9999